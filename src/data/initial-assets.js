import { collection, writeBatch, doc } from "firebase/firestore";
import { db } from "../services/firebase-config"; // <-- Đảm bảo đường dẫn này chính xác

// Dữ liệu thô đã được xử lý từ danh sách của bạn
export const rawData = [
    { department: "PHÒNG HÀNH CHÍNH -KH-ĐT (TRỆT)", assets: [
        { name: "Bàn gỗ nhân viên", size: "6,8cm x1,2m", unit: "Cái", quantity: 5, notes: "" },
        { name: "Bàn lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế chân quỳ(mới)", size: "", unit: "Cái", quantity: 6, notes: "" },
        { name: "Bàn cafe tròn+ 06 ghế", size: "80x80", unit: "cái", quantity: 1, notes: "" },
        { name: "Bàn gỗ chữ nhật+ 04 cục đôn", size: "6,5cmx 1,05m", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy photo(lớn) Ricoh 7502", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy tính bàn (LG)", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Laptop DELL đen", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Ti VI Sony 85 inch", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Camera", size: "", unit: "cái", quantity: 5, notes: "" },
        { name: "Ổn áp lioa (5kg)", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Bàn gỗ (quầy)", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Ghế quay da (quầy)", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Tủ nhôm kiếng treo tường (để HS)", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Tủ nhôm kiếng treo tường (để trà)", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy lạnh đứng (Daikin 6HP)", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Bàn kiếng nhỏ", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy chấm công", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Laptop đỏ Vaio", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Laptop HP", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy phát điện", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy ghi âm (sony)", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Bút trình chiếu", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy chup hình cơ (sony)", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy chiếu cũ (hư)", size: "", unit: "cái", quantity: 1, notes: "nhà CV" },
        { name: "Ổ cứng 8T", size: "", unit: "cái", quantity: 1, notes: "" },
    ]},
    { department: "NHÀ XE CÔNG TY", assets: [
        { name: "Bàn inox tròn", size: "", unit: "cái", quantity: 1, notes: "Đã đem vô vườn 1 cái" },
        { name: "Ghế inox", size: "", unit: "cái", quantity: 13, notes: "" },
        { name: "Tvi Sony 43in", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy rửa xe", size: "", unit: "cái", quantity: 1, notes: "Đã mua lại 1 cái" },
        { name: "Xe 67A 09090(mercedes)", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe 67A17751(Peugeot)", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe 67A 20032( Kia)", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe đạp thể thao", size: "", unit: "Chiếc", quantity: 5, notes: "" },
        { name: "Tủ đông", size: "", unit: "Cái", quantity: 1, notes: "" },
    ]},
    { department: "TỦ THIẾT BỊ ĐO ĐẠC", assets: [
        { name: "Máy đo độ sâu cầm tay", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy định vi gootex", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Thước đo điện tử", size: "", unit: "cái", quantity: 2, notes: "" },
        { name: "Thước kẹp điện tử", size: "", unit: "cái", quantity: 2, notes: "" },
        { name: "Máy thủy bình", size: "", unit: "cái", quantity: 6, notes: "" },
        { name: "Máy toàn đạt", size: "", unit: "cái", quantity: 3, notes: "" },
        { name: "Máy kinh vĩ", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Cân điện tử", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Bộ đàm", size: "", unit: "cái", quantity: 5, notes: "" },
        { name: "Máy siêu âm chiều dày", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Thước đo đường hàn", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy đo độ ẩm", size: "", unit: "cái", quantity: 1, notes: "" },
    ]},
    { department: "Phòng truyền thống", assets: [
        { name: "Tivi Sony", size: "65 inch", unit: "cái", quantity: 1, notes: "" },
        { name: "Đồng hồ treo tường", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Bàn gỗ tròn+ 10 ghế", size: "", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Ghế salon vãi", size: "", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Bàn gỗ chữ nhật + 02 chân", size: "1,1mx2,4m", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Dàn âm ly + lược + súp", size: "", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Loa thùng + dàn karaoke", size: "", unit: "Bộ", quantity: 1, notes: "" },
    ]},
    { department: "NHÀ CÔNG VỤ", assets: [
        { name: "Máy lạnh Mitsu 1.5HP", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Cặp da có quai (KT)", size: "", unit: "cái", quantity: 5, notes: "" },
        { name: "Lịch gỗ", size: "", unit: "Tấm", quantity: 4, notes: "" },
        { name: "Nệm", size: "", unit: "cái", quantity: 4, notes: "" },
        { name: "Bàn nhân viên", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Chân giá đỡ tivi 75in", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Leng khởi công công trình", size: "", unit: "Cái", quantity: 11, notes: "" },
        { name: "Nón khởi công công trình", size: "", unit: "Cái", quantity: 11, notes: "" },
        { name: "Tivi nhà máy chuyển về (hư)", size: "", unit: "Cái", quantity: 1, notes: "" },
    ]},
    { department: "PHÒNG CUNG ỨNG - LẦU 1", assets: [
        { name: "Bàn Lãnh Đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bàn Nhân Viên", size: "", unit: "Cái", quantity: 4, notes: "" },
        { name: "Ghế gỗ", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Kệ để hổ sơ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ đựng mẫu", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Bàn gỗ tiếp khách (1 bàn + 2 ghế)", size: "", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Ghế xoay", size: "", unit: "Cái", quantity: 4, notes: "" },
        { name: "Máy lạnh Mitsubishi", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Máy tính để bàn", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Máy in Canon", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy in HP LaserJet", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ đựng hồ sơ", size: "", unit: "Cái", quantity: 1, notes: "" },
    ]},
    { department: "PHÒNG TỔ THẦU - LẦU 1", assets: [
        { name: "Bàn lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bộ VPS (Tổ thầu + KH: Thắng)", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Bàn nhân viên", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Bàn gỗ lớn", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế xoay", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Ghế gỗ", size: "", unit: "Cái", quantity: 4, notes: "" },
        { name: "Kệ gỗ treo tường", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Kệ gỗ nhỏ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy in màu Epson", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy in Hp (KH: Thắng)", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy in Ricoh 301", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "CPU", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Modem wifi Dasan", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Modem wifi TP-Link", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Camera", size: "", unit: "Cái", quantity: 1, notes: "" },
    ]},
    { department: "PHÒNG HỌP 2 (THƯ GIÃN) - LẦU 1", assets: [
        { name: "Hồ cá", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Trụ trang trí gỗ+ inox", size: "", unit: "cái", quantity: 2, notes: "" },
        { name: "Ghế chân quỳ", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Bình nươc nóng( điện)pana", size: "", unit: "cai", quantity: 1, notes: "" },
        { name: "Binh gỗ quay", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Bộ ghế tiếp khách 8 món", size: "", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Máy lạnh đứng DaiKin", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tvi Sony", size: "65in", unit: "cái", quantity: 1, notes: "" },
        { name: "Bàn inox để láptop", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Kệ tủ gỗ chưng rượu", size: "1,1m x1,2m", unit: "cái", quantity: 1, notes: "" },
        { name: "Đồng hồ treo tường", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Kệ sắt để bình trà", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Kệ gỗ để bình nước uống", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Camera", size: "", unit: "cái", quantity: 1, notes: "" },
    ]},
    { department: "PHÒNG KẾ TOÁN - LẦU 2", assets: [
        { name: "Bàn gỗ", size: "", unit: "Cái", quantity: 9, notes: "" },
        { name: "Ghế Xoay", size: "", unit: "Cái", quantity: 9, notes: "" },
        { name: "Bàn gỗ lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế chân quỳ", size: "", unit: "Cái", quantity: 4, notes: "" },
        { name: "Máy tính để bàn", size: "", unit: "Cái", quantity: 9, notes: "" },
        { name: "Máy in Canon LBP2900", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy photo Canon Image Class", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy in Canon LB226dw", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ổ cứng 8T", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ hồ sơ (sắt nhỏ)", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ sắt", size: "", unit: "Cái", quantity: 3, notes: "" },
        { name: "Máy hủy giấy", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy đếm tiền", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Máy lạnh Mitsubishi", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Chân gỗ để bình nước", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Kệ kính để hồ sơ", size: "", unit: "Cái", quantity: 4, notes: "" },
        { name: "Bàn gỗ để máy in", size: "", unit: "Cái", quantity: 3, notes: "" },
        { name: "Kệ gỗ để hồ sơ (trắng)", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Tủ gỗ lưu hồ sơ (lớn)", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ gỗ đựng đồ trưng bày", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Camera", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Điện thoại bàn", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Switch mạng", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Modem Wifi", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "UPS Lưu điện", size: "", unit: "Cái", quantity: 4, notes: "" },
    ]},
    { department: "PHÒNG TỔNG GIÁM ĐỐC - LẦU 2", assets: [
        { name: "Bàn gỗ lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế da quay lưng", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bộ bàn ghế 6 món + 3 ghế đôn", size: "", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Kệ gỗ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ gỗ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Kệ gỗ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh Mitsubishi", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Điện thoại", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ lạnh Sanyo nhỏ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Trang trí inox gỗ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế gỗ cao", size: "", unit: "Cái", quantity: 2, notes: "" },
    ]},
    { department: "PHÒNG PHÓ TGĐ KH-ĐT - LẦU 2", assets: [
        { name: "Bàn gỗ lãnh đạo dài", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế quay lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế gỗ cao", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Kệ gỗ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế đôn tượng cá", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Kệ gỗ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh Mitsubishi", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ lạnh Aqua", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Quạt nhỏ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bộ máy tính Server", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ sắt", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ấm đun nước", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Kệ để ấm đun", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh Mitsubishi", size: "", unit: "Cái", quantity: 1, notes: "" },
    ]},
    { department: "PHÒNG PHÓ TGĐ XÂY DỰNG", assets: [
        { name: "Bàn gỗ lãnh đạo + mặt kính", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bàn gỗ tiếp khách + 6 món", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Kệ gỗ đựng hồ sơ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế gỗ cao", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh mitsu", size: "1.5HP", unit: "Cái", quantity: 1, notes: "" },
    ]},
    { department: "PHÒNG XNXD - LẦU 3", assets: [
        { name: "Bàn gỗ lãnh đạo + mặt kính", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Bàn gỗ nhân viên + mặt kính", size: "", unit: "Cái", quantity: 6, notes: "" },
        { name: "Ghế chân quỳ", size: "", unit: "Cái", quantity: 4, notes: "" },
        { name: "TV Sony 65 inch", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy in canon LBP3300", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "ĐT bàn", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Tủ gỗ 3 cánh", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Camera", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Máy photo Ricoh", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bàn họp (chân gỗ, mặt kính)", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế gỗ cao", size: "", unit: "Cái", quantity: 14, notes: "" },
        { name: "Kệ gỗ để máy in", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ổn áp Lioa", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh Mitshubishi 1hp + 2hp", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Kệ kính lớn", size: "", unit: "Ngăn", quantity: 3, notes: "" },
        { name: "Kệ kính nhỏ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế xoay", size: "", unit: "Cái", quantity: 3, notes: "" },
        { name: "Ghế inox", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ổn áp Sutudo", size: "", unit: "Cái", quantity: 1, notes: "" },
    ]},
    { department: "PHÒNG XNXD 2 - LẦU 3", assets: [
        { name: "Bàn gỗ dài", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bàn lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế xoay", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế inox", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bàn gỗ nhân viên + mặt kính", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Ghế chân quỳ", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Tủ gỗ kính để bằng khen", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Camera", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh Mitshubishi", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bộ máy tính bàn", size: "", unit: "Cái", quantity: 1, notes: "" },
    ]},
    { department: "PHÒNG KH-ĐT (CŨ) - LẦU 4", assets: [
        { name: "Kệ kính để hồ sơ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy in HP DesignJet 108", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bàn gỗ lãnh đạo + mặt kính", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bàn gỗ nhân viên", size: "", unit: "Cái", quantity: 3, notes: "" },
        { name: "Tủ nhôm để hồ sơ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Modem", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Đt bàn", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Camera", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Modem mạng", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "TV LG", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Đồng hồ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế gỗ LĐ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế chân quỳ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh Mitshubishi", size: "", unit: "Cái", quantity: 2, notes: "" },
    ]},
    { department: "PHÒNG CHỦ TỊCH HĐQT - LẦU 4", assets: [
        { name: "Bàn lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bộ bàn ghế 4 món", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế gỗ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ gỗ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Kệ gỗ trang trí", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh mitshubishi", size: "", unit: "Cái", quantity: 1, notes: "" },
    ]},
    { department: "PHÒNG CHỦ TỊCH CĐCS - LẦU 4", assets: [
        { name: "Bàn lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế lãnh đạo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bàn gỗ nhân viên + 1 kính", size: "", unit: "Cái", quantity: 3, notes: "" },
        { name: "Bàn xéo", size: "", unit: "Cái", quantity: 2, notes: "" },
        { name: "Kệ kinh", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh mitshubishi", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bảng viết treo tường", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bàn gỗ ngắn + kính", size: "", unit: "Cái", quantity: 1, notes: "" },
    ]},
    { department: "HỘI TRƯỜNG TẦNG 5", assets: [
        { name: "Ghế gỗ cao", size: "", unit: "cái", quantity: 56, notes: "" },
        { name: "Bàn dài", size: "", unit: "cái", quantity: 8, notes: "" },
        { name: "Máy lạnh âm trần", size: "", unit: "cái", quantity: 3, notes: "" },
        { name: "Bụt phát biểu", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Kệ kiếng để dàn âm thanh", size: "", unit: "cái", quantity: 2, notes: "" },
        { name: "Ổn áp lớn+ nhỏ", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Dàn khiển micro", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy chiếu viewsonic + màng", size: "", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Âm ly Guinness", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Lược tiếng Power", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Ghế sofa+02 cục nhỏ", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Đồng hồ treo tường", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy chiếu nhỏ", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Loa lớn", size: "", unit: "cái", quantity: 5, notes: "" },
        { name: "Loa nhỏ treo tường", size: "", unit: "cái", quantity: 4, notes: "" },
    ]},
    { department: "PHÒNG NGỦ LẦU 5", assets: [
        { name: "Giường ngủ", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Nệm", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Bàn làm việc( góc)", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Ghế lãnh đạo", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy lạnh mitsu", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Tvi 32 in", size: "Sony", unit: "cái", quantity: 1, notes: "" },
        { name: "Ghế chân quỳ", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Bàn chân sắt nhỏ", size: "", unit: "cái", quantity: 1, notes: "Đem xuống từ phòng ngủ Lầu 6" },
    ]},
    { department: "PHÒNG NGỦ LẦU 6", assets: [
        { name: "Nệm", size: "", unit: "cái", quantity: 6, notes: "" },
        { name: "Giường đệm", size: "", unit: "cái", quantity: 2, notes: "" },
        { name: "Giường gỗ", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Tủ gỗ 2 cánh", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Tủ gỗ nhỏ ngăn kéo", size: "", unit: "cái", quantity: 1, notes: "" },
        { name: "Máy lạnh mitsu", size: "1,5HP", unit: "cái", quantity: 3, notes: "" },
    ]},
    { department: "VĂN PHÒNG - NHÀ MÁY", assets: [
        { name: "Bàn gỗ lãnh đạo (đậm)", size: "", unit: "Cái", quantity: 4, notes: "Văn phòng" },
        { name: "Ghế xoay (Lãnh đạo + NV)", size: "", unit: "Cái", quantity: 7, notes: "Bao gồm 01 cái hư" },
        { name: "Bàn NV", size: "", unit: "Cái", quantity: 14, notes: "Bao gồm 03 hư ở kho, 01 NS Huy mượn" },
        { name: "Ghế chân quỳ", size: "", unit: "Cái", quantity: 12, notes: "" },
        { name: "Máy in Canon 2900", size: "", unit: "Cái", quantity: 2, notes: "(01 P.GĐ, 01 bàn Sang)" },
        { name: "Máy photo Ricoh 7502", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tivi nhỏ + lớn ( Sony)", size: "", unit: "Cái", quantity: 2, notes: "(01 vp, 01 phòng PTGĐ)" },
        { name: "Thùng loa hát", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Sofa gỗ hương", size: "", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Sofa gỗ", size: "", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Tủ đựng hồ sơ", size: "", unit: "Cái", quantity: 3, notes: "Văn phòng" },
        { name: "Két sắt", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Điện thoại bàn", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ổn áp", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Camera", size: "", unit: "Cái", quantity: 28, notes: "Bao gồm 01 cái hư" },
        { name: "Kệ trưng đá mẫu", size: "", unit: "Cái", quantity: 1, notes: "Phòng Las" },
        { name: "Bàn thờ ông địa", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy tính bàn", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh từ 1 – 2 HP", size: "", unit: "Cái", quantity: 8, notes: "X.cọc + Nhựa + Cvan + văn phòng +  phòng nghỉ P.TGĐ + P. nghỉ nam nữ" },
        { name: "Máy lạnh âm trần", size: "", unit: "Cái", quantity: 1, notes: "P.TGĐ SX" },
        { name: "Bàn gỗ tròn", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Ghế gỗ bộ tròn", size: "", unit: "Cái", quantity: 10, notes: "Gồm 01 cái hư trong kho" },
        { name: "Quạt gió remote", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Bàn gỗ làm việc P.Tổng Giám đốc", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Kệ kiếng đựng hồ sơ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ gỗ đựng hồ sơ", size: "", unit: "Cái", quantity: 1, notes: "Phòng P.Tổng giám đốc" },
        { name: "Ghế gỗ", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy in HP", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy tính bàn + màng hình cân", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ gỗ đựng quần áo", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Giường+Nệm", size: "", unit: "Bộ", quantity: 1, notes: "Phòng nghỉ P.Tổng Giám đốc" },
        { name: "Xe kia 67A - 247.92", size: "", unit: "chiếc", quantity: 1, notes: "" },
    ]},
    { department: "XE CƠ GIỚI - Nhà máy", assets: [
        { name: "Xe nâng (Xanh + vàng)", size: "", unit: "Chiếc", quantity: 2, notes: "" },
        { name: "Xe đào 07", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe lu TQ", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe xúc (1 chiếc xúc lớn, 1 chiếc xúc nhỏ)", size: "", unit: "Chiếc", quantity: 2, notes: "" },
        { name: "Xe ben (67C-08555; 67C-08668)", size: "", unit: "Chiếc", quantity: 2, notes: "" },
        { name: "Xe lôi bồi có cẩu (67C-10599)", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe lôi bồi không cẩu (67C-08282)", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe tải cẩu (67C-07770)", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe rùa thảm nhựa", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe lu ba bánh sắt", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe lu hai bánh sắt", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Xe lu bánh lốp", size: "", unit: "Chiếc", quantity: 1, notes: "" },
        { name: "Roomoc ngắn (67R.00051; 67R.00053)", size: "", unit: "TB", quantity: 2, notes: "" },
        { name: "Roomoc dài (67R-001.33)", size: "", unit: "TB", quantity: 1, notes: "" },
    ]},
    { department: "XE CƠ GIỚI - XNXD", assets: [
        { name: "Xe lu rung bánh hơi 1/. BS 67-SA 0171 2/. BS 67-SA 0155 3/. BS 67-SA 0166 4/. BS 67-SA 0078", size: "", unit: "chiếc", quantity: 4, notes: "" },
        { name: "Xe lu tay - máy dầu 500kg", size: "", unit: "chiếc", quantity: 1, notes: "" },
        { name: "Xe đào 08 - Kobelco vàng", size: "", unit: "chiếc", quantity: 1, notes: "" },
        { name: "Xe đào 05 - Kobelco xanh", size: "", unit: "chiếc", quantity: 1, notes: "" },
        { name: "Xe đào 025 1/. Kubota đen - tím 2/. Komatshu vàng", size: "", unit: "chiếc", quantity: 2, notes: "" },
        { name: "Xe trộn bê tông", size: "", unit: "chiếc", quantity: 1, notes: "" },
        { name: "Cẩu tháp 0,6 - 6 tấn", size: "", unit: "chiếc", quantity: 1, notes: "" },
        { name: "Xe ben 3500kg - BS 67C-06152", size: "", unit: "chiếc", quantity: 1, notes: "" },
        { name: "Xe ủi D20 1/. Misubishi DB2F 2/. Komatshu D2", size: "", unit: "Chiếc", quantity: 2, notes: "" },
        { name: "Xe ủi D30 - BS 67-XA - 0422", size: "", unit: "chiếc", quantity: 1, notes: "" },
    ]},
    { department: "PHÒNG LAS - NHÀ MÁY", assets: [
        { name: "Máy kéo thép vạn năng 1000KN", size: "", unit: "Ch", quantity: 1, notes: "" },
        { name: "Bộ gá kéo cáp dự ứng lực", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "búa thử độ cứng bê tông", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Máy siêu âm bê tông Matest-italy", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Máy siêu âm cốt thép", size: "", unit: "bô", quantity: 1, notes: "" },
        { name: "Máy xác định dộ thấm bê tông", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Khuốn đúc mẫu thấm bê tông", size: "", unit: "ch", quantity: 6, notes: "" },
        { name: "Bộ gá mẫu thấm bê tông hình trụ", size: "", unit: "bộ", quantity: 6, notes: "" },
        { name: "Bàn dằn vữa xi măng", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Máy ly tâm tách nhựa", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Giấy lọc cho ly tâm 3000g", size: "", unit: "hộp", quantity: 1, notes: "" },
        { name: "Máy nén marshall", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Bộ đầm mẫu marshall bằng tay", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "Côn thử độ sụt bê tông N1", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "phiễu rót cát hiện trường (nhôm)", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "Lưỡi dao vòng", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "Chụp dao vòng", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "Máy thử độ mài mòn Los Angeles", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Máy khoan lấy mẫu bê tông", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Mũi khoan kim cương đk 101,6mm", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Bộ sàng tiêu chuẩn D300mm", size: "", unit: "t.bộ", quantity: 1, notes: "" },
        { name: "Bộ sàng đá D300mm", size: "", unit: "t.bộ", quantity: 1, notes: "" },
        { name: "Bộ sàng đá cấp phối D300mm", size: "", unit: "t.bộ", quantity: 1, notes: "" },
        { name: "Bộ sàng cốt liệu BTN D300mm", size: "", unit: "t.bộ", quantity: 1, notes: "" },
        { name: "Đồng hồ so 10mmx0,01", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Cối Proctor tiêu chuẩn", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Cối Proctor cải tiến", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Chày Proctor tiêu chuẩn", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Chày Proctor cải tiến", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Thiết bị kiểm tra khuyết tật mối hàn", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Tủ sấy 300oC", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Lò nung 1000oC", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Bể ổn nhiệt marshall 32 lít", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Bộ kim lún tự động", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "Thiết bị hóa mềm nhựa tự động", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "Thiết bị thí nghiệm bốc cháy", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "Cân kỹ thuật 3000g", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Cân kỹ thuật 15kg", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Máy lắc sàng D200/D300", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Nhiệt kế kim loại 250oC", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Nhiệt kế điện tử dạng bút", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Thước kẹp 200mm điện tử Insize", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Bộ đo E bằng tấm ép tĩnh", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "Bộ cần Benkenman", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "Thiết bị giãn dài nhựa hiển thị số", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Khuôn mẫu chuẩn hình số 8", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Đế khuốn đúc mẫu giãn dài nhựa", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Dụng cụ xác định khối lượng riêng Bê tông nhựa", size: "", unit: "bộ", quantity: 1, notes: "" },
        { name: "Máy đo điện trở đất 4105A", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Cân điện tử 30kg", size: "", unit: "ch", quantity: 1, notes: "" },
        { name: "Máy nén 3000kg", size: "", unit: "Bộ", quantity: 1, notes: "" },
        { name: "Kệ sắt trưng bày", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy cắt bàn", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy khoan Booch cầm tay", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Tủ nhôm để thiết bị", size: "", unit: "Bộ", quantity: 1, notes: "" },
    ]},
    { department: "NHÀ ĐIỀU HÀNH BẮC LONG XUYÊN", assets: [
        { name: "Bàn gỗ NV ( gỗ đậm)", size: "", unit: "Cái", quantity: 3, notes: "" },
        { name: "Bàn dài mặt đá + chân sắt", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Máy lạnh mitsu", size: "", unit: "Cái", quantity: 1, notes: "" },
        { name: "Camera", size: "", unit: "Cái", quantity: 3, notes: "" },
        { name: "Ghế chân quỳ( xanh)", size: "", unit: "Cái", quantity: 5, notes: "" },
        { name: "Ghế lãnh đạo xoay", size: "", unit: "Cái", quantity: 1, notes: "" },
    ]},
];

/**
 * Hàm này sẽ tạo phòng ban và tài sản ban đầu lên Firestore.
 * CHỈ CHẠY HÀM NÀY MỘT LẦN DUY NHẤT.
 */
export const uploadInitialData = async () => {
    console.log("Bắt đầu quá trình khởi tạo dữ liệu...");

    try {
        const batch = writeBatch(db);
        const departmentMap = new Map();

        // 1. Chuẩn bị tạo các phòng ban và lưu lại ID của chúng
        for (const group of rawData) {
            const deptName = group.department;
            if (deptName && !departmentMap.has(deptName)) {
                const deptRef = doc(collection(db, "departments"));
                batch.set(deptRef, { name: deptName });
                departmentMap.set(deptName, deptRef.id);
            }
        }

        // 2. Chuẩn bị tạo các tài sản với departmentId tương ứng
        for (const group of rawData) {
            const departmentId = departmentMap.get(group.department);
            if (!departmentId) continue;

            for (const asset of group.assets) {
                const assetRef = doc(collection(db, "assets"));
                const assetData = {
                    name: asset.name || "N/A",
                    description: asset.size || "",
                    unit: asset.unit || "Cái",
                    quantity: asset.quantity || 1,
                    notes: asset.notes || "",
                    departmentId: departmentId, // Quan trọng: Gán ID của phòng ban
                };
                batch.set(assetRef, assetData);
            }
        }
        
        // 3. Thực thi tất cả các lệnh ghi cùng một lúc
        await batch.commit();
        console.log("✅ Khởi tạo dữ liệu thành công!");
        return { success: true, message: `Đã tạo thành công ${departmentMap.size} phòng ban và ${rawData.flatMap(g => g.assets).length} tài sản.` };
    } catch (error) {
        console.error("❌ Lỗi nghiêm trọng khi khởi tạo dữ liệu:", error);
        return { success: false, message: `Lỗi: ${error.message}` };
    }
};

